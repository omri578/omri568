<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>×œ×•×— ×ª×•×¦××•×ª</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b5b2a">

  <style>
    body{margin:0;font-family:Arial;background:#000}
    .app{
      min-height:100vh;
      background:url("assets/pitch.jpg") center/cover no-repeat;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
    }
    .overlay{position:absolute;inset:0;background:rgba(0,0,0,.45)}
    .content{position:relative;z-index:2;width:100%;max-width:980px}
    h1{color:#fff;text-align:center;margin:8px 0 14px}

    .row{display:flex;align-items:center;justify-content:space-between;gap:12px}

    .team{
      width:30%;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      cursor:pointer;
    }

    .logo{
      width:100px;height:100px;
      border-radius:18px;
      overflow:hidden;
      border:3px solid #fff;
      background:rgba(0,0,0,.2);
    }
    .logo img{width:100%;height:100%;object-fit:cover}
    .name{color:#fff;font-weight:800;text-align:center}

    .scorebox{
      background:rgba(0,0,0,.7);
      border-radius:18px;
      padding:14px 20px;
      display:flex;
      align-items:center;
      gap:16px;
    }

    .score{
      color:#fff;
      font-size:52px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      padding:2px 10px;
      border-radius:12px;
    }
    .score:active{transform:scale(.99)}
    .dash{color:#fff;font-size:36px;font-weight:700}

    .buttons{
      display:flex;
      justify-content:center;
      gap:10px;
      margin-top:16px;
      flex-wrap:wrap;
    }

    button{
      padding:10px 14px;
      border:none;
      border-radius:12px;
      font-weight:800;
      cursor:pointer;
    }
    .btn-primary{background:#ffffff}
    .btn-warn{background:#ffd54a}
    .btn-danger{background:#ff7676}
    .btn-dark{background:#1f1f1f;color:#fff}

    .mode-pill{
      display:inline-block;
      background:rgba(0,0,0,.55);
      color:#fff;
      padding:8px 12px;
      border-radius:999px;
      font-weight:900;
      margin:0 auto 10px;
    }

    .hint{
      color:#fff;
      text-align:center;
      opacity:.9;
      margin-top:10px;
      font-weight:700;
    }

    .varBox{
      margin-top:10px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .varStatus{
      color:#fff;
      background:rgba(0,0,0,.65);
      padding:8px 12px;
      border-radius:12px;
      font-weight:900;
      min-height:18px;
    }

    dialog{
      border:none;
      border-radius:16px;
      padding:14px;
      max-width:500px;
      width:90%;
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:10px;
      margin-top:10px;
    }

    .pick{
      border:2px solid #ddd;
      border-radius:14px;
      padding:8px;
      cursor:pointer;
      text-align:center;
      background:#fff;
    }

    .pick img{
      width:70px;height:70px;
      border-radius:14px;
      object-fit:cover;
    }

    /* ×“×¤×™× */
    .screen{display:none;}
    .screen.active{display:block;}
  </style>
</head>
<body>

<div class="app">
  <div class="overlay"></div>

  <div class="content">

    <!-- ===== ××¡×š ×¨××©×™ ===== -->
    <div class="screen active" id="screenMain">
      <div class="mode-pill">××¦×‘ ×¨×’×™×œ</div>
      <h1>×œ×•×— ×ª×•×¦××•×ª</h1>

      <div class="row">
        <div class="team" onclick="openPicker('home')">
          <div class="logo"><img id="homeLogo" src="assets/team1.png" alt=""></div>
          <div class="name" id="homeName">×§×‘×•×¦×” ××³</div>
        </div>

        <div class="scorebox">
          <div class="score" id="homeScore">0</div>
          <div class="dash">-</div>
          <div class="score" id="awayScore">0</div>
        </div>

        <div class="team" onclick="openPicker('away')">
          <div class="logo"><img id="awayLogo" src="assets/team2.png" alt=""></div>
          <div class="name" id="awayName">×§×‘×•×¦×” ×‘×³</div>
        </div>
      </div>

      <div class="buttons">
        <button class="btn-primary" onclick="resetScore()">××™×¤×•×¡</button>
        <button class="btn-warn" onclick="undoGoal()">×‘×˜×œ ×’×•×œ</button>
        <button class="btn-dark" onclick="goToPenalties()">××¦×‘ ×¤× ×“×œ×™×</button>
      </div>

      <div class="hint">×œ×—×¥ ×¢×œ ×”××¡×¤×¨ ×›×“×™ ×œ×”×•×¡×™×£ ×’×•×œ âš½</div>
    </div>

    <!-- ===== ××¡×š ×¤× ×“×œ×™× ===== -->
    <div class="screen" id="screenPen">
      <div class="mode-pill">××¦×‘ ×¤× ×“×œ×™×</div>
      <h1>×¤× ×“×œ×™×</h1>

      <div class="row">
        <div class="team" onclick="openPicker('home')">
          <div class="logo"><img id="homeLogo2" src="assets/team1.png" alt=""></div>
          <div class="name" id="homeName2">×§×‘×•×¦×” ××³</div>
        </div>

        <div class="scorebox">
          <div class="score" id="homePen">0</div>
          <div class="dash">-</div>
          <div class="score" id="awayPen">0</div>
        </div>

        <div class="team" onclick="openPicker('away')">
          <div class="logo"><img id="awayLogo2" src="assets/team2.png" alt=""></div>
          <div class="name" id="awayName2">×§×‘×•×¦×” ×‘×³</div>
        </div>
      </div>

      <div class="varBox">
        <button class="btn-danger" onclick="runVAR()">VAR</button>
        <div class="varStatus" id="varStatus">VAR: ×¢×•×“ ×œ× × ×‘×“×§</div>
      </div>

      <div class="buttons">
        <button class="btn-primary" onclick="resetPens()">××™×¤×•×¡ ×¤× ×“×œ×™×</button>
        <button class="btn-warn" onclick="undoPen()">×‘×˜×œ ×¤× ×“×œ</button>
        <button class="btn-dark" onclick="backToMain()">×—×–×¨×” ×œ×œ×•×— ×”×¨××©×™</button>
      </div>

      <div class="hint">×œ×—×¥ ×¢×œ ×”××¡×¤×¨ ×›×“×™ ×œ×”×•×¡×™×£ ×¤× ×“×œ. ×•××– ××¤×©×¨ ×œ×œ×—×•×¥ VAR ğŸ¥</div>
    </div>

  </div>
</div>

<audio id="goalSound" src="assets/goal.mp3" preload="auto"></audio>

<dialog id="picker">
  <h3 id="pickerTitle">×‘×—×¨ ×§×‘×•×¦×”</h3>
  <div class="grid" id="grid"></div>
  <div style="text-align:right;margin-top:10px">
    <button onclick="picker.close()">×¡×’×•×¨</button>
  </div>
</dialog>

<script>
  // ===== ×§×‘×•×¦×•×ª (×“×•×’××”) =====
  const teams = [
    {name:"××›×‘×™ ×ª×œ ××‘×™×‘", logo:"assets/team1.png"},
    {name:"×”×¤×•×¢×œ ×ª×œ ××‘×™×‘", logo:"assets/team2.png"},
    {name:"××›×‘×™ ×—×™×¤×”", logo:"assets/team3.png"},
    {name:"×‘×™×ª×´×¨ ×™×¨×•×©×œ×™×", logo:"assets/team4.png"},
    {name:"×”×¤×•×¢×œ ×‘××¨ ×©×‘×¢", logo:"assets/team5.png"},
    {name:"× ×ª× ×™×”", logo:"assets/team6.png"}
  ];

  // ===== ××•×“×™×• =====
  const goalSound = document.getElementById("goalSound");
  function playGoal(){
    try { goalSound.currentTime = 0; goalSound.play(); } catch(e) {}
  }

  // ===== ××¡×›×™× =====
  const screenMain = document.getElementById("screenMain");
  const screenPen  = document.getElementById("screenPen");
  let currentMode = "main"; // "main" / "pen"

  function showScreen(which){
    currentMode = which;
    screenMain.classList.toggle("active", which === "main");
    screenPen.classList.toggle("active", which === "pen");
    // ×”×•×“×¢×ª VAR ××ª××¤×¡×ª ×›×©× ×›× ×¡×™×
    if(which === "pen") document.getElementById("varStatus").textContent = "VAR: ×¢×•×“ ×œ× × ×‘×“×§";
  }

  function goToPenalties(){
    // ×¡× ×›×¨×•×Ÿ ×œ×•×’×•××™×/×©××•×ª ×œ××¡×š ×¤× ×“×œ×™×
    syncTeamsToPenaltyScreen();
    showScreen("pen");
  }
  function backToMain(){
    showScreen("main");
  }

  // ===== ××¦×‘ ×¨×’×™×œ =====
  const homeScore = document.getElementById("homeScore");
  const awayScore = document.getElementById("awayScore");

  let lastMain = null; // "home"/"away"

  homeScore.onclick = () => goalMain("home");
  awayScore.onclick = () => goalMain("away");

  function goalMain(side){
    if(side==="home") homeScore.textContent = String(Number(homeScore.textContent) + 1);
    else awayScore.textContent = String(Number(awayScore.textContent) + 1);
    lastMain = side;
    playGoal();
  }

  function resetScore(){
    homeScore.textContent = "0";
    awayScore.textContent = "0";
    lastMain = null;
  }

  function undoGoal(){
    if(lastMain==="home"){
      homeScore.textContent = String(Math.max(0, Number(homeScore.textContent) - 1));
    } else if(lastMain==="away"){
      awayScore.textContent = String(Math.max(0, Number(awayScore.textContent) - 1));
    }
    lastMain = null;
  }

  // ===== ××¦×‘ ×¤× ×“×œ×™× =====
  const homePen = document.getElementById("homePen");
  const awayPen = document.getElementById("awayPen");

  let lastPen = null; // "home"/"away"
  let lastPenWasGoal = false; // ×›×“×™ ×œ×“×¢×ª ×× VAR ×¨×œ×•×•× ×˜×™

  homePen.onclick = () => addPen("home");
  awayPen.onclick = () => addPen("away");

  function addPen(side){
    if(side==="home") homePen.textContent = String(Number(homePen.textContent) + 1);
    else awayPen.textContent = String(Number(awayPen.textContent) + 1);

    lastPen = side;
    lastPenWasGoal = true;

    document.getElementById("varStatus").textContent = "VAR: ××¤×©×¨ ×œ×‘×“×•×§ ××ª ×”×’×•×œ ×”××—×¨×•×Ÿ";
    playGoal();
  }

  function resetPens(){
    homePen.textContent = "0";
    awayPen.textContent = "0";
    lastPen = null;
    lastPenWasGoal = false;
    document.getElementById("varStatus").textContent = "VAR: ×¢×•×“ ×œ× × ×‘×“×§";
  }

  function undoPen(){
    if(lastPen==="home"){
      homePen.textContent = String(Math.max(0, Number(homePen.textContent) - 1));
    } else if(lastPen==="away"){
      awayPen.textContent = String(Math.max(0, Number(awayPen.textContent) - 1));
    }
    lastPen = null;
    lastPenWasGoal = false;
    document.getElementById("varStatus").textContent = "VAR: ×¢×•×“ ×œ× × ×‘×“×§";
  }

  // ===== VAR (50/50) =====
  function runVAR(){
    const status = document.getElementById("varStatus");

    if(!lastPenWasGoal || !lastPen){
      status.textContent = "VAR: ××™×Ÿ ×’×•×œ ××—×¨×•×Ÿ ×œ×‘×“×™×§×”";
      return;
    }

    const isGoal = Math.random() < 0.5; // 50% ×›×Ÿ / 50% ×œ×

    if(isGoal){
      status.textContent = "VAR: âœ… ×”×’×•×œ ××•×©×¨!";
      // × ×©××¨ ××•×ª×• ×“×‘×¨
    } else {
      status.textContent = "VAR: âŒ ×”×’×•×œ × ×¤×¡×œ!";
      // ××•×¨×™×“×™× 1 ××”×¦×“ ×”××—×¨×•×Ÿ (×× ××¤×©×¨)
      if(lastPen === "home"){
        homePen.textContent = String(Math.max(0, Number(homePen.textContent) - 1));
      } else {
        awayPen.textContent = String(Math.max(0, Number(awayPen.textContent) - 1));
      }
    }

    // ××—×¨×™ VAR ××¡×™×™××™× ××ª ×”×‘×“×™×§×” (×›×“×™ ×©×œ× ×™×œ×—×¦×• ×©×•×‘ ×¢×œ ××•×ª×• ×’×•×œ)
    lastPenWasGoal = false;
    lastPen = null;
  }

  // ===== ×‘×—×™×¨×ª ×§×‘×•×¦×” (×¢×•×‘×“ ×œ×©× ×™ ×”××¡×›×™×) =====
  const picker = document.getElementById("picker");
  const grid = document.getElementById("grid");
  let pickSide = "home";

  function openPicker(side){
    pickSide = side;
    document.getElementById("pickerTitle").textContent =
      side === "home" ? "×‘×—×¨ ×§×‘×•×¦×” (×‘×™×ª)" : "×‘×—×¨ ×§×‘×•×¦×” (×—×•×¥)";

    grid.innerHTML = "";
    teams.forEach(t=>{
      const d=document.createElement("div");
      d.className="pick";
      d.innerHTML=`<img src="${t.logo}" alt=""><div style="font-weight:900;margin-top:6px">${t.name}</div>`;
      d.onclick=()=>{
        setTeam(side, t);
        picker.close();
      };
      grid.appendChild(d);
    });

    picker.showModal();
  }

  function setTeam(side, team){
    // ××¡×š ×¨××©×™
    document.getElementById(side+"Logo").src = team.logo;
    document.getElementById(side+"Name").textContent = team.name;

    // ××¡×š ×¤× ×“×œ×™× (×œ×•×’×•/×©× ×©× ×™)
    document.getElementById(side+"Logo2").src = team.logo;
    document.getElementById(side+"Name2").textContent = team.name;
  }

  function syncTeamsToPenaltyScreen(){
    // ××¢×ª×™×§ ××”××¡×š ×”×¨××©×™ ×œ××¡×š ×¤× ×“×œ×™× (×œ×™×ª×¨ ×‘×™×˜×—×•×Ÿ)
    document.getElementById("homeLogo2").src = document.getElementById("homeLogo").src;
    document.getElementById("awayLogo2").src = document.getElementById("awayLogo").src;
    document.getElementById("homeName2").textContent = document.getElementById("homeName").textContent;
    document.getElementById("awayName2").textContent = document.getElementById("awayName").textContent;
  }

  // ===== Service Worker =====
  if("serviceWorker" in navigator){
    navigator.serviceWorker.register("sw.js");
  }
</script>

</body>
</html>
